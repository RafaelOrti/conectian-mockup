<div class="client-payments-page">
  <app-navbar 
    *ngIf="showNavbar"
    [userRole]="'CLIENT'" 
    [userName]="'Carlos Mart√≠nez'"
    [notificationCount]="3"
    [messageCount]="2"
    [projectCount]="4"
  ></app-navbar>
  
  <div class="container">
    <div class="page-header d-flex justify-between align-start mb-8">
      <div>
        <h1 class="mb-2">üí≥ Pagos y Facturaci√≥n</h1>
        <p class="text-secondary">Gestiona tus m√©todos de pago y descarga facturas</p>
      </div>
      <button class="btn btn-primary">
        <span class="icon">‚ûï</span> A√±adir M√©todo de Pago
      </button>
    </div>

    <div class="payments-layout d-flex flex-column gap-10">
      <!-- Payment Methods -->
      <section class="payment-methods-section">
        <h2 class="text-xl mb-6">M√©todos de Pago</h2>
        <div class="cards-grid d-grid gap-6" style="grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));">
          <div class="card payment-method-card active d-flex flex-column justify-between p-6 min-h-48 relative" style="border: 1px solid #3b82f6; background: linear-gradient(135deg, rgba(13, 134, 255, 0.1) 0%, rgba(13, 134, 255, 0.05) 100%);">
            <div class="card-header d-flex justify-between align-start">
              <span class="card-brand text-xl font-bold italic">VISA</span>
              <span class="badge badge-primary">Predeterminado</span>
            </div>
            <div class="card-number text-xl font-mono tracking-wider my-4">**** **** **** 4242</div>
            <div class="card-footer d-flex justify-between align-center">
              <span class="text-sm text-secondary">Expira 12/28</span>
              <button class="btn btn-link p-0 text-blue">Editar</button>
            </div>
          </div>
          
          <div class="card payment-method-card d-flex flex-column justify-between p-6 min-h-48" style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);">
            <div class="card-header">
              <span class="card-brand text-xl font-bold italic">Mastercard</span>
            </div>
            <div class="card-number text-xl font-mono tracking-wider my-4">**** **** **** 8899</div>
            <div class="card-footer d-flex justify-between align-center">
              <span class="text-sm text-secondary">Expira 09/27</span>
              <button class="btn btn-link p-0 text-blue">Editar</button>
            </div>
          </div>

          <button class="add-card-btn d-flex flex-column align-center justify-center gap-3 p-6 rounded-lg cursor-pointer transition-all hover:bg-surface-hover hover:text-blue hover:border-blue" style="min-height: 180px; background: rgba(255,255,255,0.02); border: 2px dashed rgba(255,255,255,0.1); color: #94a3b8;">
            <span class="plus-icon text-3xl">+</span>
            <span>A√±adir nueva tarjeta</span>
          </button>
        </div>
      </section>

      <!-- Billing History -->
      <section class="billing-history-section">
        <h2 class="text-xl mb-6">Historial de Facturaci√≥n</h2>
        <div class="card history-card">
          <div class="table-filters d-flex justify-between mb-6">
            <div class="search-box relative" style="width: 300px;">
              <span class="search-icon absolute left-3 top-50 translate-y-50 text-muted">üîç</span>
              <input type="text" placeholder="Buscar factura..." class="input p-inputtext pl-10">
            </div>
            <select class="input p-inputtext w-auto">
              <option value="2025">2025</option>
              <option value="2024">2024</option>
            </select>
          </div>

          <table class="p-datatable w-full">
            <thead class="p-datatable-thead">
              <tr>
                <th class="text-left p-4 text-secondary font-medium border-bottom border-surface-border" style="border-bottom: 1px solid rgba(255,255,255,0.1);">Factura</th>
                <th class="text-left p-4 text-secondary font-medium border-bottom border-surface-border" style="border-bottom: 1px solid rgba(255,255,255,0.1);">Fecha</th>
                <th class="text-left p-4 text-secondary font-medium border-bottom border-surface-border" style="border-bottom: 1px solid rgba(255,255,255,0.1);">Concepto</th>
                <th class="text-left p-4 text-secondary font-medium border-bottom border-surface-border" style="border-bottom: 1px solid rgba(255,255,255,0.1);">Monto</th>
                <th class="text-left p-4 text-secondary font-medium border-bottom border-surface-border" style="border-bottom: 1px solid rgba(255,255,255,0.1);">Estado</th>
                <th class="text-left p-4 text-secondary font-medium border-bottom border-surface-border" style="border-bottom: 1px solid rgba(255,255,255,0.1);">Acciones</th>
              </tr>
            </thead>
            <tbody class="p-datatable-tbody">
              <tr *ngFor="let invoice of invoices" class="hover:bg-surface-hover transition-colors">
                <td class="p-4 border-bottom border-surface-border" style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                  <span class="font-mono text-blue">{{invoice.id}}</span>
                </td>
                <td class="p-4 border-bottom border-surface-border" style="border-bottom: 1px solid rgba(255,255,255,0.05);">{{invoice.date}}</td>
                <td class="p-4 border-bottom border-surface-border" style="border-bottom: 1px solid rgba(255,255,255,0.05);">{{invoice.concept}}</td>
                <td class="p-4 border-bottom border-surface-border" style="border-bottom: 1px solid rgba(255,255,255,0.05);">{{invoice.amount}}</td>
                <td class="p-4 border-bottom border-surface-border" style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                  <span class="badge" [ngClass]="{'badge-success': invoice.status === 'paid', 'badge-warning': invoice.status !== 'paid'}">
                    {{invoice.status === 'paid' ? 'Pagado' : 'Pendiente'}}
                  </span>
                </td>
                <td class="p-4 border-bottom border-surface-border" style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                  <button class="btn btn-sm btn-secondary d-flex align-center gap-2" title="Descargar PDF">
                    üì• PDF
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </div>
  </div>
</div>

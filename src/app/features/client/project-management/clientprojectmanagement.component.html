<div class="project-management-page">
  <app-navbar 
    [userRole]="'CLIENT'"
    [userName]="'Carlos Martínez'"
    [notificationCount]="3"
  ></app-navbar>
  
  <div class="container">
    <!-- Header -->
    <header class="page-header">
      <h1>NUEVO DISEÑO - Gestión de Proyectos</h1>
      <p class="subtitle">Casos de uso aceptados con Deal Room activo</p>
    </header>

    <!-- Projects List -->
    <div class="projects-grid" *ngIf="projects.length > 0; else emptyState">
      <div *ngFor="let project of projects" class="project-item">
        <div class="project-card" (click)="openDealRoom(project.dealRoomId)">
          <!-- Background Image -->
          <div class="card-background">
            <div class="bg-overlay"></div>
            <div class="bg-pattern"></div>
          </div>

          <!-- Status Badge -->
          <div class="status-badge" [attr.data-status]="project.status">
            <p-tag 
              [value]="getStatusLabel(project.status)" 
              [severity]="getSeverity(project.status)"
              [icon]="project.status === 'active' ? 'pi pi-check-circle' : project.status === 'on-hold' ? 'pi pi-pause' : 'pi pi-flag'"
            ></p-tag>
          </div>

          <!-- Provider Logo -->
          <div class="client-logo-container">
            <div class="client-logo-circle">
              <span class="client-logo-emoji">{{ project.provider.logo }}</span>
            </div>
          </div>

          <!-- Card Content -->
          <div class="card-content">
            <!-- Provider Name & Category -->
            <div class="card-header-section">
              <div class="client-name-badge">{{ project.provider.name }}</div>
              <div class="category-tag" *ngIf="project.category">
                <i class="pi pi-tag"></i>
                {{ project.category }}
              </div>
            </div>

            <!-- Project Title -->
            <h2 class="project-title">{{ project.title }}</h2>

            <!-- Progress Bar -->
            <div class="progress-section" *ngIf="project.progress">
              <div class="progress-header">
                <span class="progress-label">Progreso del Proyecto</span>
                <span class="progress-percentage">{{ project.progress }}%</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-bar-fill" [style.width.%]="project.progress"></div>
              </div>
            </div>

            <!-- Project Details Grid -->
            <div class="details-grid">
              <div class="detail-item" *ngIf="project.value">
                <div class="detail-icon-wrapper value">
                  <i class="pi pi-dollar"></i>
                </div>
                <div class="detail-content">
                  <span class="detail-label">Valor</span>
                  <span class="detail-value">${{ project.value.toLocaleString() }}</span>
                </div>
              </div>

              <div class="detail-item" *ngIf="project.timeline">
                <div class="detail-icon-wrapper timeline">
                  <i class="pi pi-clock"></i>
                </div>
                <div class="detail-content">
                  <span class="detail-label">Duración</span>
                  <span class="detail-value">{{ project.timeline }}</span>
                </div>
              </div>

              <div class="detail-item">
                <div class="detail-icon-wrapper calendar">
                  <i class="pi pi-calendar"></i>
                </div>
                <div class="detail-content">
                  <span class="detail-label">Aceptado</span>
                  <span class="detail-value">{{ project.acceptedDate }}</span>
                </div>
              </div>

              <div class="detail-item">
                <div class="detail-icon-wrapper activity">
                  <i class="pi pi-bolt"></i>
                </div>
                <div class="detail-content">
                  <span class="detail-label">Última Actividad</span>
                  <span class="detail-value">{{ project.lastActivity }}</span>
                </div>
              </div>
            </div>

            <!-- Action Button -->
            <div class="card-action">
              <button class="open-deal-room-btn">
                <span>Abrir Deal Room</span>
                <i class="pi pi-arrow-right"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <ng-template #emptyState>
      <div class="empty-state">
        <p-card styleClass="empty-card">
          <div class="empty-content">
            <i class="pi pi-folder-open empty-icon"></i>
            <h2>No hay proyectos activos</h2>
            <p>Cuando aceptes un caso de uso y se cree un Deal Room, aparecerá aquí.</p>
          </div>
        </p-card>
      </div>
    </ng-template>
  </div>
</div>

